<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<!-- BEGIN HEAD -->

<head>

<meta charset="utf-8" />

<title>新增驾校或考场-财务管理-驾考联盟后台管理系统</title>

<meta content="width=device-width, initial-scale=1.0" name="viewport" />

<meta content="" name="description" />

<meta content="" name="author" />

<!-- BEGIN GLOBAL MANDATORY STYLES -->

<link href="../media/css/bootstrap.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/bootstrap-responsive.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/font-awesome.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/style-metro.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/style.css" rel="stylesheet" type="text/css" />

<link href="../media/css/style-responsive.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/default.css" rel="stylesheet" type="text/css"
	id="style_color" />

<link href="../media/css/uniform.default.css" rel="stylesheet"
	type="text/css" />
<!-- <link href="../media/css/select2_metro.css" rel="stylesheet" type="text/css"/> -->
<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN PAGE LEVEL STYLES -->

<link rel="stylesheet" href="../media/css/DT_bootstrap.css" />

<!-- END PAGE LEVEL STYLES -->

<link rel="shortcut icon" href="../media/image/favicon.ico" />
<link href="../media/css/validationEngine.jquery.css" rel="stylesheet" type="text/css">

</head>

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

	<!-- BEGIN HEADER -->

	<div class="header navbar navbar-inverse navbar-fixed-top">

		<!-- BEGIN TOP NAVIGATION BAR -->

		<div class="navbar-inner">


		</div>

		<!-- END TOP NAVIGATION BAR -->

	</div>

	<!-- END HEADER -->

	<!-- BEGIN CONTAINER -->

	<div class="page-container row-fluid">

		<!-- 开始侧边栏 -->

		<div class="page-sidebar nav-collapse collapse">

			<!-- 开始 左侧通用 菜单 -->
			<!-- END SIDEBAR MENU -->

		</div>

		<!-- 结束侧边栏 -->

		<!-- BEGIN PAGE -->

		<div class="page-content">

			<!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

			<div id="portlet-config" class="modal hide">

				<div class="modal-header">

					<button data-dismiss="modal" class="close" type="button"></button>

					<h3>portlet Settings</h3>

				</div>

				<div class="modal-body">

					<p>Here will be a configuration form</p>

				</div>

			</div>

			<!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

			<!-- BEGIN PAGE CONTAINER-->

			<div class="container-fluid">

				<!-- BEGIN PAGE HEADER-->

				<div class="row-fluid">

					<div class="span12">

						<!-- BEGIN STYLE CUSTOMIZER -->

						<div class="color-panel hidden-phone">

							<div class="color-mode-icons icon-color"></div>

							<div class="color-mode-icons icon-color-close"></div>

							<div class="color-mode">

								<p>更改后台颜色</p>

								<ul class="inline">

									<li class="color-black current color-default"
										data-style="default"></li>

									<li class="color-blue" data-style="blue"></li>

									<li class="color-brown" data-style="brown"></li>

									<li class="color-purple" data-style="purple"></li>

									<li class="color-grey" data-style="grey"></li>

									<li class="color-white color-light" data-style="light"></li>

								</ul>



							</div>

						</div>

						<!-- END BEGIN STYLE CUSTOMIZER -->

						<!-- BEGIN PAGE TITLE & BREADCRUMB-->

						<h3 class="page-title">
							新增教练<small>增加教练</small>

						</h3>

						<ul class="breadcrumb">

							<li><i class="icon-home"></i> <a href="../main/main.jsp">后台首页</a>

								<i class="icon-angle-right"></i></li>

							<li><a href="techer_view_list.html">教练信息</a> <i
								class="icon-angle-right"></i></li>

							<li><a href="javascript:void(0);">新增教练</a></li>

						</ul>

						<!-- END PAGE TITLE & BREADCRUMB-->

					</div>

				</div>







				<div class="portlet box blue">

					<div class="portlet-title">

						<div class="caption">
							<i class="icon-cogs"></i>新增教练
						</div>

						<div class="actions" style="margin-left:15px;"></div>
						<div class="tools">



							<a href="javascript:void(0)" class="reload" onclick="$('#form').validationEngine('hideAll')"></a>




						</div>

					</div>

					<div class="portlet-body">
						<h3 class="form-section">教练基本信息</h3>
						<form class="form-horizontal" id="form" enctype="multipart/form-data" 
							action="../rest/coachBasicInfo/addWithPhoto" method="post" target="formIframe">

							<div class="control-group">

								<label class="control-label"><span class="required">*</span>所属驾校</label>

								<div class="controls" >
									<div id="selectSchoolDiv" style="display:none">
									<select  class="medium m-wrap" tabindex="1" id="selectSchool" name="school_id" 
										  onchange="displayCoachNumbers(this.value);">
									</select>
									</div>
									<label id="setSchoolName"  style="dispaly:none; font-size:1.25em;margin-right:10px;"></label>
									 <span class="btn red disabled">还可增加<span id="remainCoachNumbers">0</span>位教练！</span><span
										class="help-inline"> 注：在此处显示还可以增加多少位教练</span>
								</div>
							</div>

							<div class="control-group">

								<label class="control-label"><span class="required">*</span>姓名</label>

								<div class="controls">

									<input type="text" placeholder="教练姓名" class="validate[required, maxSize[10]] m-wrap medium" name="coach_name" />

									<span class="help-inline">教练姓名</span>

								</div>

							</div>
							<div class="control-group">

								<label class="control-label"><span class="required">*</span>身份证号</label>

								<div class="controls">

									<input type="text" class="validate[required, maxSize[19]] m-wrap medium" name="identity_card_no" />
								</div>

							</div>
							<div class="control-group">

								<label class="control-label">教龄</label>

								<div class="controls">

									<input type="text" placeholder="从业年数" class="validate[max[100]] m-wrap small" name="teaching_age" /><span
										class="help-inline"> 年</span>
								</div>

							</div>



							<div class="control-group">

								<label class="control-label">性别</label>

								<div class="controls">

									<label class="radio"> <input type="radio"
										name="gender" value="0" checked /> 男
									</label> <label class="radio"> <input type="radio"
										name="gender" value="1" /> 女

									</label>




								</div>

							</div>

							<!-- <div class="control-group">

								<label class="control-label">所教科目</label>

								<div class="controls">

									<label class="radio"> <input type="radio"
										name="optionsRadioss2" value="option1" /> 科二

									</label> <label class="radio"> <input type="radio"
										name="optionsRadioss2" value="option2" checked /> 科三

									</label>

								</div>

							</div>

							<div class="control-group">

								<label class="control-label">科三设备</label>

								<div class="controls">

									<label class="checkbox"> <input type="checkbox"
										value="" disabled /> 路考王专业设备

									</label> <span class="btn red disabled">余0台路考王专业设备</span><span
										class="help-inline"> 注：这里显示驾校还能添加多少台带设备如果为零则此项不可选</span>





								</div>

							</div>






							<div class="control-group">

								<label class="control-label">车型</label>

								<div class="controls">

									<input type="text" class="m-wrap medium" placeholder="车辆型号"
										value="新捷达" />
								</div>

							</div> -->
							<div class="control-group">

								<label class="control-label">当前状态</label>

								<div class="controls">

									<label class="radio"> <input type="radio"
										name="validation" value="0"  /> 暂停

									</label> <label class="radio"> <input type="radio"
										name="validation" value="1" checked /> 有效

									</label>
								</div>

							</div>

							<div class="control-group">

								<label class="control-label">照片</label>
								<div class="controls">
									<div class="fileupload-new thumbnail" id="preview"
										style="width: 200px; height: 200px;">
										<img src="../media/image/profile.jpg" alt="教练头像"
											style="width:100%;height:100%;">
									</div>
									<input type="file" class="default" name="photo" onchange="previewImage(this)" />

								</div>

							</div>

							<div class="control-group">

								<label class="control-label">当前级别</label>

								<div class="controls">

									<select class="medium m-wrap" tabindex="1" id="selectCoachStar" name="star">
										<option value="1" selected>一星级教练</option>
										<option value="2">二星级教练</option>
										<option value="3">三星级教练</option>
										<option value="4">四星级教练</option>
										<option value="5">五星级教练</option>

									</select>

								</div>
								<h3 class="form-section" style="margin-top:15px;">教练帐户信息</h3><span
											class="help-inline">注意：以下信息添加后不能修改</span>
								<div class="control-group">

									<label class="control-label"><span class="required">*</span>手机号</label>

									<div class="controls">

										<input type="text" class="validate[required, custom[phone]] span6 m-wrap" name="phone" /> <span
											class="help-inline">手机号为用户名</span>

									</div>

								</div>

								<div class="control-group">

									<label class="control-label"><span class="required">*</span>密码</label>

									<div class="controls">

										<input type="password" class="validate[required, maxSize[20], minSize[6]] span6 m-wrap" name="login_pwd"
											id="password" /> <span class="help-inline">输入密码</span>

									</div>

								</div>

								<div class="control-group">

									<label class="control-label"><span class="required">*</span>重复密码</label>

									<div class="controls">

										<input type="password" class="validate[equals[password]] span6 m-wrap" />

										<span class="help-inline">再输入一次</span>

									</div>

								</div>

								<div class="control-group">

									<label class="control-label"><span class="required">*</span>预留码</label>

									<div class="controls">

										<input type="text" class="validate[required] span6 m-wrap" name="obligate_code" /> <span
											class="help-inline">输入您的预留码</span>

									</div>

								</div>

							</div>
							<button type="submit" style="margin-left:100px;" class="btn blue" id="submit">添加</button>
							<!-- <a href="javascript:void(0)" class="btn blue" style="margin-left:100px;" onclick="add()" id="submit">添加</a> -->
							<button type="reset" class="btn" onclick="$('#form').validationEngine('hideAll')">取消</button>
						</form>
					</div>

				</div>

				<!-- END PAGE CONTENT-->

			</div>

			<!-- END PAGE CONTAINER-->

		</div>

		<!-- END PAGE -->

	</div>

	<!-- END CONTAINER -->

	<!-- BEGIN FOOTER -->

	<div class="footer">

		<div class="footer-inner">2013 &copy; HenanZhonghe Inc.</div>

		<div class="footer-tools">

			<span class="go-top"> <i class="icon-angle-up"></i>

			</span>

		</div>
	</div>
	<iframe name="formIframe" style="display:none;"></iframe>
	<!-- END FOOTER -->

	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

	<!-- BEGIN CORE PLUGINS -->

	<script src="../media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery-migrate-1.2.1.min.js"
		type="text/javascript"></script>

	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

	<script src="../media/js/jquery-ui-1.10.1.custom.min.js"
		type="text/javascript"></script>

	<script src="../media/js/bootstrap.min.js" type="text/javascript"></script>

	<!--[if lt IE 9]>

	<script src="media/js/excanvas.min.js"></script>

	<script src="media/js/respond.min.js"></script>  

	<![endif]-->

	<script src="../media/js/jquery.slimscroll.min.js"
		type="text/javascript"></script>

	<script src="../media/js/jquery.blockui.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery.cookie.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery.uniform.min.js" type="text/javascript"></script>

	<!-- END CORE PLUGINS -->

	<!-- BEGIN PAGE LEVEL PLUGINS -->

	<!-- <script type="text/javascript" src="../media/js/select2.min.js"></script> -->

	<script type="text/javascript"
		src="../media/js/jquery.dataTables.min.js"></script>

	<script type="text/javascript" src="../media/js/DT_bootstrap.js"></script>

	<!-- END PAGE LEVEL PLUGINS -->

	<!-- BEGIN PAGE LEVEL SCRIPTS -->

	<script src="../media/js/app.js"></script>
	<script src="../media/js/picPreview.js"></script>
	<script src="../media/js/table-advanced.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
	<script type="text/javascript" src="../media/js/jquery.validationEngine-zh_CN.js"></script>
	<script type="text/javascript" src="../media/js/jquery.validationEngine.js"></script>
	<script>
	    var dataArray = new Array();
		jQuery(document).ready(function() {       
		   App.init();
		   $('#form').validationEngine();
		   var school_id = $('#school_id').val();
		   if(school_id != 0){
			   $('#setSchoolName').css('display', 'inline').html($('#school_name').val());
			   displayCoachNumbers(school_id);
		   }else{
			   $('#selectSchoolDiv').css('display', 'block');
			   selectSchool();
		   }
		});
	function displayCoachNumbers(id){
		if($('#school_id').val() == 0){
			var number;
			for(i in dataArray){
				if(dataArray[i].id == id){
					number = dataArray[i].numbers;
					break;
				}
				else
					number = 0;
			}
			if(number == 0){
				alert('不能选择教练');
				document.getElementById('submit').disabled = true;
			}
			$('#remainCoachNumbers').html(number);
		}else{
			$.ajax({
				url: '../rest/schoolInfo/getAvaiableCoachNumbers',
				type: 'get',
				dataType: 'json',
				data: {
					school_id: id
				},
				complete: function(xhr, err){
					if(xhr.status == 200){
						var number = parseInt(JSON.parse(xhr.responseText).desc);
						$('#remainCoachNumbers').html(number);
						if(number == 0){
							alert('不能选择教练');
							document.getElementById('submit').disabled = true;
						}
					}else if(xhr.status == 500){
						alert(JSON.parse(xhr.responseText).desc + ', ' + err);
					}else
						alert('网络错误');
				}
			});
		}
	}
	function selectSchool(){
		//var dataArray = new Array();
		$('#selectCoachStar').select2();
		   $.ajax({
			   url: '../rest/schoolInfo/webSelectSchool',
			   type: 'get',
			   dataType: 'json',
			   success: function(data){
				   if(data.length != 0){
					   for(i in data){
							 dataArray[i]  = new Object();
							 dataArray[i].id = data[i].school_id;
							 dataArray[i].text = data[i].school_name;
							 dataArray[i].numbers = data[i].numbers;
							 /* dataArray[i].id = data[i].id;
							 dataArray[i].text = data[i].text; */
						 }
				   }else{
					   dataArray[0] = new Object();
					   dataArray[0].id = -1;
					   dataArray[0].text = '没有数据';
				   }
			   },
			   complete: function(xhr, ts){
				   if(dataArray.length == 0){
					   dataArray[0] = new Object();
					   dataArray[0].id = -1;
					   dataArray[0].text = '没有数据';
				   }
				   $('#selectSchool').select2({
					  placeholder: '请选择驾校',
					  data: dataArray
				   });
				   if(dataArray[0].id != -1)
				   	//displayCoachNumbers($('#selectSchool').val());
					   $('#remainCoachNumbers').html(dataArray[0].numbers);
			   }
		   });
	}
	</script>

</body>

<!-- END BODY -->

</html>