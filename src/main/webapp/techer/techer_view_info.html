<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<!-- BEGIN HEAD -->

<head>

<meta charset="utf-8" />

<title>新增驾校或考场-财务管理-驾考联盟后台管理系统</title>

<meta content="width=device-width, initial-scale=1.0" name="viewport" />

<meta content="" name="description" />

<meta content="" name="author" />

<!-- BEGIN GLOBAL MANDATORY STYLES -->

<link href="../media/css/bootstrap.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/bootstrap-responsive.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/font-awesome.min.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/style-metro.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/style.css" rel="stylesheet" type="text/css" />

<link href="../media/css/style-responsive.css" rel="stylesheet"
	type="text/css" />

<link href="../media/css/default.css" rel="stylesheet" type="text/css"
	id="style_color" />

<link href="../media/css/uniform.default.css" rel="stylesheet"
	type="text/css" />

<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN PAGE LEVEL STYLES -->

<!-- <link rel="stylesheet" type="text/css"
	href="../media/css/select2_metro.css" /> -->
<link
	href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css"
	rel="stylesheet" />

<link rel="stylesheet" href="../media/css/DT_bootstrap.css" />

<!-- END PAGE LEVEL STYLES -->

<link rel="shortcut icon" href="../media/image/favicon.ico" />
<link href="../media/css/validationEngine.jquery.css" rel="stylesheet"
	type="text/css">
</head>

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

	<!-- BEGIN HEADER -->

	<div class="header navbar navbar-inverse navbar-fixed-top">

		<!-- BEGIN TOP NAVIGATION BAR -->

		<div class="navbar-inner">


		</div>

		<!-- END TOP NAVIGATION BAR -->

	</div>

	<!-- END HEADER -->

	<!-- BEGIN CONTAINER -->

	<div class="page-container row-fluid">

		<!-- 开始侧边栏 -->

		<div class="page-sidebar nav-collapse collapse">

			<!-- 开始 左侧通用 菜单 -->
			<!-- END SIDEBAR MENU -->

		</div>

		<!-- 结束侧边栏 -->

		<!-- BEGIN PAGE -->

		<div class="page-content">

			<!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

			<div id="portlet-config" class="modal hide">

				<div class="modal-header">

					<button data-dismiss="modal" class="close" type="button"></button>

					<h3>portlet Settings</h3>

				</div>

				<div class="modal-body">

					<p>Here will be a configuration form</p>

				</div>

			</div>

			<!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

			<!-- BEGIN PAGE CONTAINER-->

			<div class="container-fluid">

				<!-- BEGIN PAGE HEADER-->

				<div class="row-fluid">

					<div class="span12">

						<!-- BEGIN STYLE CUSTOMIZER -->

						<div class="color-panel hidden-phone">

							<div class="color-mode-icons icon-color"></div>

							<div class="color-mode-icons icon-color-close"></div>

							<div class="color-mode">

								<p>更改后台颜色</p>

								<ul class="inline">

									<li class="color-black current color-default"
										data-style="default"></li>

									<li class="color-blue" data-style="blue"></li>

									<li class="color-brown" data-style="brown"></li>

									<li class="color-purple" data-style="purple"></li>

									<li class="color-grey" data-style="grey"></li>

									<li class="color-white color-light" data-style="light"></li>

								</ul>



							</div>

						</div>

						<!-- END BEGIN STYLE CUSTOMIZER -->

						<!-- BEGIN PAGE TITLE & BREADCRUMB-->

						<h3 class="page-title">
							<span id="coach_name"></span><small>教练信息</small>

						</h3>

						<ul class="breadcrumb">

							<li><i class="icon-home"></i> <a href="../main.jsp">后台首页</a>

								<i class="icon-angle-right"></i></li>

							<li><a href="techer_view_list.html">教练信息</a> <i
								class="icon-angle-right"></i></li>

							<li><a href="#">教练资料</a></li>

						</ul>

						<!-- END PAGE TITLE & BREADCRUMB-->

					</div>

				</div>



				<a class=" btn purple" href="techer_view_info.html" id="teachInfo"
					style="margin-bottom:10px;"><i class="icon-hospital"
					style="margin-right:5px;"></i>教练信息</a> <a class=" btn blue"
					id="orderRecord" href="techer_view_money.html"
					style="margin-bottom:10px;"><i class=" icon-user-md"
					style="margin-right:5px;"></i>订单记录</a> <!-- <a id="studentInfo"
					class=" btn blue" href="techer_view_students.html"
					style="margin-bottom:10px;"><i class=" icon-male"
					style="margin-right:5px;"></i>名下学员</a> --> <a class=" btn blue"
					id="evaluationInfo" href="techer_view_pingjia.html"
					style="margin-bottom:10px;"><i class="icon-hospital"
					style="margin-right:5px;"></i>获得评价</a><a class=" btn blue"
					id="scheduleInfo" href="techer_view_paiban.html"
					style="margin-bottom:10px;"><i class="icon-hospital"
					style="margin-right:5px;"></i>教练排班</a>


				<div class="portlet box blue">

					<div class="portlet-title">

						<div class="caption">
							<i class="icon-cogs"></i>教练资料
						</div>

						<div class="actions" style="margin-left:15px;"></div>
						<div class="tools">



							<a href="javascript:;" class="reload"></a>




						</div>

					</div>

					<div class="portlet-body">
						<h3 class="form-section">教练基本信息</h3>
						<form class="form-horizontal" id="form"
							enctype="multipart/form-data" method="post" target="formIframe">

							<div class="control-group">

								<label class="control-label"><span class="required">*</span>所属驾校</label>

								<div class="controls">

									<select class="medium m-wrap" tabindex="1" id="selectSchool"
										name="school_id" onchange="displayCoachNumbers(this.value);">
									</select> <span class="btn red disabled">还可增加<span
										id="remainCoachNumbers">0</span>位教练！
									</span><span class="help-inline"> 注：在选择驾校后此处显示还可以增加多少位教练</span>
								</div>
							</div>

							<div class="control-group">

								<label class="control-label"><span class="required">*</span>姓名</label>

								<div class="controls">

									<input type="text" placeholder="教练姓名"
										class="validate[required, maxSize[10]] m-wrap medium"
										name="coach_name" /> <span class="help-inline">教练姓名</span>

								</div>

							</div>
							<div class="control-group">

								<label class="control-label"><span class="required">*</span>身份证号</label>

								<div class="controls">

									<input type="text"
										class="validate[required, maxSize[19]] m-wrap medium"
										name="identity_card_no" />
								</div>

							</div>
							<div class="control-group">

								<label class="control-label">教龄</label>

								<div class="controls">

									<input type="text" placeholder="从业年数"
										class="validate[max[100]] m-wrap small" name="teaching_age" /><span
										class="help-inline"> 年</span>
								</div>

							</div>



							<div class="control-group">

								<label class="control-label">性别</label>

								<div class="controls">

									<label class="radio"> <input type="radio" name="gender"
										value="0" checked /> 男
									</label> <label class="radio"> <input type="radio"
										name="gender" value="1" /> 女

									</label>




								</div>

							</div>



							<div class="control-group">

								<label class="control-label">照片</label>

								<div class="controls">

									<div class="fileupload-new thumbnail"
										style="width: 200px; height: 200px;" id="preview">
										<img src="../media/image/profile.jpg" alt="教练头像" id="photo"
											style="width:100%;height:100%;">
									</div>




									<input type="file" style="margin-top:10px;" class="default"
										name="photo" onchange="previewImage(this)"/>

								</div>

							</div>


							<div class="control-group">

								<label class="control-label">当前级别</label>

								<div class="controls">

									<select class="medium m-wrap" tabindex="1" id="selectCoachStar"
										name="star">
										<option value="1" selected>一星级教练</option>
										<option value="2">二星级教练</option>
										<option value="3">三星级教练</option>
										<option value="4">四星级教练</option>
										<option value="5">五星级教练</option>

									</select>

								</div>
								<h3 class="form-section" style="margin-top:15px;">教练帐户信息</h3>
								<div class="control-group">

									<label class="control-label" style="display: inline"><!-- <span class="required">*</span> -->手机号：</label>

									<div class="controls" >
										<label id="phone" style="display: inline;"></label>
										<!-- <input type="text"
											class="validate[required, custom[phone]] span6 m-wrap"
											name="phone" />  <span class="help-inline">手机号为用户名</span>-->

									</div>

								</div>

								<!-- <div class="control-group">

									<label class="control-label"><span class="required">*</span>密码</label>

									<div class="controls">
										<label id="password"></label>
										<input type="password"
											class="validate[required, maxSize[20], minSize[6]] span6 m-wrap"
											name="login_pwd" id="password" /> <span class="help-inline">输入密码</span>

									</div>

								</div>

								<div class="control-group">

									<label class="control-label"><span class="required">*</span>重复密码</label>

									<div class="controls">

										<input type="password"
											class="validate[equals[password]] span6 m-wrap" id="repwd" />

										<span class="help-inline">再输入一次</span>

									</div>

								</div> -->

								<div class="control-group">

									<label class="control-label"><!-- <span class="required">*</span> -->预留码：</label>
									
									<div class="controls">
										<label id="obligate_code" style="display: inline"></label>
										<!-- <input type="text" class="validate[required] span6 m-wrap"
											name="obligate_code" />  <span class="help-inline">输入您的预留码</span>-->

									</div>

								</div>

							</div>
							<button type="submit" style="margin-left:100px;" class="btn blue"
								id="submit">添加</button>
							<!-- <a href="javascript:void(0)" class="btn blue" style="margin-left:100px;" onclick="add()" id="submit">添加</a> -->
							<button type="reset" class="btn"
								onclick="$('#form').validationEngine('hideAll')">取消</button>
						</form>
					</div>

				</div>

				<!-- END PAGE CONTENT-->

			</div>

			<!-- END PAGE CONTAINER-->

		</div>

		<!-- END PAGE -->

	</div>

	<!-- END CONTAINER -->

	<!-- BEGIN FOOTER -->

	<div class="footer">

		<div class="footer-inner">2013 &copy; HenanZhonghe Inc.</div>

		<div class="footer-tools">

			<span class="go-top"> <i class="icon-angle-up"></i>

			</span>

		</div>
	</div>
	<iframe style="display:none;" name="formIframe"></iframe>
	<!-- END FOOTER -->

	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

	<!-- BEGIN CORE PLUGINS -->

	<script src="../media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery-migrate-1.2.1.min.js"
		type="text/javascript"></script>

	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

	<script src="../media/js/jquery-ui-1.10.1.custom.min.js"
		type="text/javascript"></script>

	<script src="../media/js/bootstrap.min.js" type="text/javascript"></script>

	<!--[if lt IE 9]>

	<script src="media/js/excanvas.min.js"></script>

	<script src="media/js/respond.min.js"></script>  

	<![endif]-->

	<script src="../media/js/jquery.slimscroll.min.js"
		type="text/javascript"></script>

	<script src="../media/js/jquery.blockui.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery.cookie.min.js" type="text/javascript"></script>

	<script src="../media/js/jquery.uniform.min.js" type="text/javascript"></script>

	<!-- END CORE PLUGINS -->

	<!-- BEGIN PAGE LEVEL PLUGINS -->

	<!-- <script type="text/javascript" src="../media/js/select2.min.js"></script> -->
	<script
		src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
	<script type="text/javascript"
		src="../media/js/jquery.dataTables.min.js"></script>

	<script type="text/javascript" src="../media/js/DT_bootstrap.js"></script>

	<!-- END PAGE LEVEL PLUGINS -->

	<!-- BEGIN PAGE LEVEL SCRIPTS -->

	<script src="../media/js/app.js"></script>
	<script src="../media/js/picPreview.js"></script>
	<script src="../media/js/table-advanced.js"></script>
	<script type="text/javascript"
		src="../media/js/jquery.validationEngine-zh_CN.js"></script>
	<script type="text/javascript"
		src="../media/js/jquery.validationEngine.js"></script>
	<script>
	    var dataArray = new Array();
		jQuery(document).ready(
				function() {

					//App.init();

					//TableAdvanced.init();
					$('#selectCoachStar').select2();
					$('#form').validationEngine();
					var search = window.location.search;
					var decodeSearch = decodeURIComponent(search);
					var coach_id, coach_name;
					try{
						coach_id = decodeSearch.split('&')[0].split('=')[1];
						coach_name = decodeSearch.split('&')[1].split('=')[1];
						$('#coach_name').html(coach_name);
					}catch(err){
						return;
					}
					loadPageInfo(coach_id);
					$('#teachInfo').attr('href', 'techer_view_info.html' + search);
					$('#orderRecord').attr('href', 'techer_view_money.html' + search);
					$('#studentInfo').attr('href', 'techer_view_students.html' + search);
					$('#evaluationInfo').attr('href', 'techer_view_pingjia.html' + search);
					$('#scheduleInfo').attr('href', 'techer_view_paiban.html' + search);
				});
		function displayCoachNumbers(id) {
			/* $.ajax({
						url : '../rest/schoolInfo/getAvaiableCoachNumbers',
						type : 'get',
						dataType : 'json',
						data : {
							school_id : id
						},
						complete : function(xhr, err) {
							if (xhr.status == 200) {
								var number = parseInt(JSON
										.parse(xhr.responseText).desc);
								$('#remainCoachNumbers').html(number);
								if (number == 0) {
									alert('不能选择教练');
									document.getElementById('submit').disabled = true;
								}
							} else if (xhr.status == 500) {
								alert(JSON.parse(xhr.responseText).desc + ', '
										+ err);
							} else
								alert('网络错误');
						}
					}); */
			var number;
			for(i in dataArray){
				if(dataArray[i].id == id){
					number = dataArray[i].numbers;
					break;
				}
				else
					number = 0;
			}
			if(number == 0){
				alert('不能选择教练');
				document.getElementById('submit').disabled = true;
			}
			$('#remainCoachNumbers').html(number);
		}
		function loadSchoolInfo(id) {
			$.ajax({
				url : '../rest/schoolInfo/webSelectSchool',
				type : 'get',
				dataType : 'json',
				success : function(data) {
					if (data.length != 0) {
						for (i in data) {
							dataArray[i] = new Object();
							dataArray[i].id = data[i].school_id;
							dataArray[i].text = data[i].school_name;
							dataArray[i].numbers = data[i].numbers;
						}
					} else {
						dataArray[0] = new Object();
						dataArray[0].id = -1;
						dataArray[0].text = '没有数据';
					}
				},
				complete : function(xhr, ts) {
					if (dataArray.length == 0) {
						dataArray[0] = new Object();
						dataArray[0].id = -1;
						dataArray[0].text = '没有数据';
					}
					$('#selectSchool').select2({
						placeholder : '请选择驾校',
						data : dataArray
					});
					if (dataArray[0].id != -1) {
						$('#selectSchool').val(id);
						$('#selectSchool').change();
						displayCoachNumbers($('#selectSchool').val());

					}
				}
			});
		}
		function loadPageInfo(coach_id) {
			$.ajax({
					url : '../rest/coachBasicInfo/' + coach_id,
					type : 'get',
					dataType : 'json',
					success : function(data) {
						$('#form').attr(
								'action',
								'../rest/coachBasicInfo/updateWithPhoto/'
										+ data.coach_id);
						document.getElementsByName('coach_name')[0].value = data.coach_name;
						document.getElementsByName('identity_card_no')[0].value = data.identity_card_no;
						document.getElementsByName('teaching_age')[0].value = data.teaching_age;
						document.getElementsByName('gender')[data.gender].checked = true;
						/* document.getElementsByName('star')[0].value= data.star;
						document.getElementsByName('star')[0].onchange(); */
						$('#selectCoachStar').val(data.star);
						$('#selectCoachStar').change();
						/* document.getElementsByName('phone')[0].value = data.phone;
						document.getElementsByName('login_pwd')[0].value = data.login_pwd;
						$('#repwd').val(data.login_pwd);
						document.getElementsByName('obligate_code')[0].value = data.obligate_code; */
						$('#phone').html(data.phone);
						$('#obligate_code').html(data.obligate_code);
						loadSchoolInfo(data.school_id);
						if (data.havePhoto == 1) {
							$('#photo').attr(
									'src',
									'../rest/coachBasicInfo/downloadPhoto?id='
											+ data.coach_id);
						}
					},
					error : function(xhr, err) {
						alert(xhr.responseText + ', ' + err
								+ 'rrorrororrororo');
					},
					complete : function(xhr, ts) {
						App.init();
					}
				});
		}
	</script>

</body>

<!-- END BODY -->

</html>